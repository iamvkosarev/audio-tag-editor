// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.977
package templates

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

func Index() templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<!doctype html><html lang=\"en\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>Music Tag Editor</title><style>\n\t\t\t\tbody {\n\t\t\t\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\n\t\t\t\t\tmax-width: 1200px;\n\t\t\t\t\tmargin: 0 auto;\n\t\t\t\t\tpadding: 2rem;\n\t\t\t\t\tbackground-color: #f5f5f5;\n\t\t\t\t}\n\t\t\t\t.container {\n\t\t\t\t\tbackground: white;\n\t\t\t\t\tborder-radius: 8px;\n\t\t\t\t\tpadding: 2rem;\n\t\t\t\t\tbox-shadow: 0 2px 4px rgba(0,0,0,0.1);\n\t\t\t\t}\n\t\t\t\th1 {\n\t\t\t\t\tcolor: #333;\n\t\t\t\t\tmargin-top: 0;\n\t\t\t\t}\n\t\t\t\t.upload-section {\n\t\t\t\t\tmargin: 2rem 0;\n\t\t\t\t}\n\t\t\t\t.actions-section {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tgap: 0.5rem;\n\t\t\t\t\tmargin: 1rem 0;\n\t\t\t\t\tflex-wrap: wrap;\n\t\t\t\t}\n\t\t\t\t.file-input-wrapper {\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tdisplay: inline-block;\n\t\t\t\t}\n\t\t\t\t.file-input {\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\topacity: 0;\n\t\t\t\t\twidth: 0;\n\t\t\t\t\theight: 0;\n\t\t\t\t}\n\t\t\t\t.upload-btn, .action-btn {\n\t\t\t\t\tbackground-color: #007bff;\n\t\t\t\t\tcolor: white;\n\t\t\t\t\tpadding: 0.75rem 1.5rem;\n\t\t\t\t\tborder: none;\n\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t\tfont-size: 1rem;\n\t\t\t\t\ttransition: background-color 0.2s;\n\t\t\t\t}\n\t\t\t\t.upload-btn:hover, .action-btn:hover {\n\t\t\t\t\tbackground-color: #0056b3;\n\t\t\t\t}\n\t\t\t\t.action-btn:disabled {\n\t\t\t\t\tbackground-color: #ccc;\n\t\t\t\t\tcursor: not-allowed;\n\t\t\t\t}\n\t\t\t\t.action-btn.active {\n\t\t\t\t\tbackground-color: #28a745;\n\t\t\t\t}\n\t\t\t\t.action-btn.edit-btn {\n\t\t\t\t\tbackground-color: #ffc107;\n\t\t\t\t\tcolor: #333;\n\t\t\t\t}\n\t\t\t\t.action-btn.edit-btn:hover:not(:disabled) {\n\t\t\t\t\tbackground-color: #e0a800;\n\t\t\t\t}\n\t\t\t\t.action-btn.edit-btn:disabled {\n\t\t\t\t\tbackground-color: #ccc;\n\t\t\t\t\tcolor: #666;\n\t\t\t\t\tcursor: not-allowed;\n\t\t\t\t}\n\t\t\t\t.edit-form {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t\tbackground: white;\n\t\t\t\t\tborder: 2px solid #007bff;\n\t\t\t\t\tborder-radius: 8px;\n\t\t\t\t\tpadding: 1.5rem;\n\t\t\t\t\tmargin: 1rem 0;\n\t\t\t\t}\n\t\t\t\t.edit-form.active {\n\t\t\t\t\tdisplay: block;\n\t\t\t\t}\n\t\t\t\t.edit-form h3 {\n\t\t\t\t\tmargin-top: 0;\n\t\t\t\t\tcolor: #333;\n\t\t\t\t}\n\t\t\t\t.form-group {\n\t\t\t\t\tmargin: 1rem 0;\n\t\t\t\t}\n\t\t\t\t.form-group label {\n\t\t\t\t\tdisplay: block;\n\t\t\t\t\tmargin-bottom: 0.5rem;\n\t\t\t\t\tfont-weight: 600;\n\t\t\t\t\tcolor: #333;\n\t\t\t\t}\n\t\t\t\t.form-group input {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tpadding: 0.5rem;\n\t\t\t\t\tborder: 1px solid #ddd;\n\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\tfont-size: 1rem;\n\t\t\t\t\tbox-sizing: border-box;\n\t\t\t\t}\n\t\t\t\t.form-actions {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tgap: 0.5rem;\n\t\t\t\t\tmargin-top: 1rem;\n\t\t\t\t}\n\t\t\t\t.btn-primary {\n\t\t\t\t\tbackground-color: #007bff;\n\t\t\t\t\tcolor: white;\n\t\t\t\t\tpadding: 0.5rem 1rem;\n\t\t\t\t\tborder: none;\n\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t}\n\t\t\t\t.btn-primary:hover {\n\t\t\t\t\tbackground-color: #0056b3;\n\t\t\t\t}\n\t\t\t\t.btn-secondary {\n\t\t\t\t\tbackground-color: #6c757d;\n\t\t\t\t\tcolor: white;\n\t\t\t\t\tpadding: 0.5rem 1rem;\n\t\t\t\t\tborder: none;\n\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t}\n\t\t\t\t.btn-secondary:hover {\n\t\t\t\t\tbackground-color: #5a6268;\n\t\t\t\t}\n\t\t\t\t.files-table tr.selected {\n\t\t\t\t\tbackground-color: #e7f3ff;\n\t\t\t\t}\n\t\t\t\t.changed {\n\t\t\t\t\tbackground-color: #fff3cd;\n\t\t\t\t}\n\t\t\t\t.checkbox-cell {\n\t\t\t\t\twidth: 30px;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t}\n\t\t\t\t.files-table {\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tborder-collapse: collapse;\n\t\t\t\t\tmargin-top: 2rem;\n\t\t\t\t\tfont-size: 0.9rem;\n\t\t\t\t}\n\t\t\t\t.files-table th,\n\t\t\t\t.files-table td {\n\t\t\t\t\tpadding: 0.5rem;\n\t\t\t\t\ttext-align: left;\n\t\t\t\t\tborder-bottom: 1px solid #ddd;\n\t\t\t\t}\n\t\t\t\t.files-table th {\n\t\t\t\t\tbackground-color: #f8f9fa;\n\t\t\t\t\tfont-weight: 600;\n\t\t\t\t\tcolor: #333;\n\t\t\t\t\tposition: sticky;\n\t\t\t\t\ttop: 0;\n\t\t\t\t}\n\t\t\t\t.files-table th.sortable {\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t\tuser-select: none;\n\t\t\t\t\tposition: relative;\n\t\t\t\t\tpadding-right: 1.5rem;\n\t\t\t\t}\n\t\t\t\t.files-table th.sortable:hover {\n\t\t\t\t\tbackground-color: #e9ecef;\n\t\t\t\t}\n\t\t\t\t.files-table th.sortable .sort-indicator {\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\tright: 0.5rem;\n\t\t\t\t\ttop: 50%;\n\t\t\t\t\ttransform: translateY(-50%);\n\t\t\t\t\tfont-size: 0.8rem;\n\t\t\t\t\tcolor: #007bff;\n\t\t\t\t}\n\t\t\t\t.files-table th.sortable .sort-indicator::after {\n\t\t\t\t\tcontent: ' ↕';\n\t\t\t\t\topacity: 0.3;\n\t\t\t\t}\n\t\t\t\t.files-table th.sortable.sort-asc .sort-indicator::after {\n\t\t\t\t\tcontent: ' ↑';\n\t\t\t\t\topacity: 1;\n\t\t\t\t}\n\t\t\t\t.files-table th.sortable.sort-desc .sort-indicator::after {\n\t\t\t\t\tcontent: ' ↓';\n\t\t\t\t\topacity: 1;\n\t\t\t\t}\n\t\t\t\t.files-table tr:hover {\n\t\t\t\t\tbackground-color: #f8f9fa;\n\t\t\t\t}\n\t\t\t\t.files-table td {\n\t\t\t\t\tmax-width: 150px;\n\t\t\t\t\toverflow: hidden;\n\t\t\t\t\ttext-overflow: ellipsis;\n\t\t\t\t\twhite-space: nowrap;\n\t\t\t\t}\n\t\t\t\t.cover-art {\n\t\t\t\t\twidth: 60px;\n\t\t\t\t\theight: 60px;\n\t\t\t\t\tobject-fit: cover;\n\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t}\n\t\t\t\t.cover-art-placeholder {\n\t\t\t\t\twidth: 60px;\n\t\t\t\t\theight: 60px;\n\t\t\t\t\tbackground-color: #e0e0e0;\n\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tcolor: #999;\n\t\t\t\t\tfont-size: 0.7rem;\n\t\t\t\t}\n\t\t\t\t.empty-state {\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\tpadding: 3rem;\n\t\t\t\t\tcolor: #666;\n\t\t\t\t}\n\t\t\t\t.loading {\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\tpadding: 2rem;\n\t\t\t\t\tcolor: #666;\n\t\t\t\t}\n\t\t\t</style></head><body><div class=\"container\"><h1>Music Tag Editor</h1><div class=\"upload-section\"><div class=\"file-input-wrapper\"><input type=\"file\" id=\"fileInput\" class=\"file-input\" multiple accept=\"audio/*\"> <button class=\"upload-btn\" onclick=\"document.getElementById('fileInput').click()\">Load Files</button></div></div><div class=\"actions-section\" id=\"actionsSection\" style=\"display: none;\"><button class=\"action-btn\" id=\"selectBtn\" onclick=\"toggleSelectMode()\">Select</button> <button class=\"action-btn edit-btn\" id=\"editBtn\" onclick=\"showEditForm()\" disabled style=\"display: none;\">Edit</button> <button class=\"action-btn\" id=\"downloadBtn\" onclick=\"downloadSelectedFiles()\" disabled style=\"display: none;\">Download Selected</button> <button class=\"action-btn\" onclick=\"downloadAllFiles()\">Download All</button></div><div class=\"edit-form\" id=\"editForm\"><h3>Edit Tags</h3><div class=\"form-group\"><label for=\"editTitle\">Title:</label> <input type=\"text\" id=\"editTitle\" placeholder=\"Enter track title\"></div><div class=\"form-group\"><label for=\"editArtist\">Artist:</label> <input type=\"text\" id=\"editArtist\" placeholder=\"Enter artist name\"></div><div class=\"form-group\"><label for=\"editAlbum\">Album:</label> <input type=\"text\" id=\"editAlbum\" placeholder=\"Enter album name\"></div><div class=\"form-group\"><label for=\"editYear\">Year:</label> <input type=\"number\" id=\"editYear\" placeholder=\"Enter year\" min=\"1900\" max=\"2100\"></div><div class=\"form-group\"><label for=\"editTrack\">Track:</label> <input type=\"number\" id=\"editTrack\" placeholder=\"Enter track number\" min=\"1\"></div><div class=\"form-group\"><label for=\"editGenre\">Genre:</label> <input type=\"text\" id=\"editGenre\" placeholder=\"Enter genre\"></div><div class=\"form-actions\"><button class=\"btn-primary\" onclick=\"saveTags()\">Save</button> <button class=\"btn-secondary\" onclick=\"cancelEdit()\">Cancel</button></div></div><div id=\"filesContainer\"><div class=\"empty-state\">No files loaded yet. Click \"Load Files\" to select audio files.</div></div></div><script>\n\t\t\t\tlet currentFiles = [];\n\t\t\t\tlet sortState = { column: 'track', direction: 'asc' };\n\t\t\t\tlet selectionMode = false;\n\t\t\t\tlet selectedFileIds = new Set();\n\t\t\t\tlet fileIdMap = new Map();\n\n\t\t\t\tdocument.getElementById('fileInput').addEventListener('change', async function(e) {\n\t\t\t\t\tconst files = e.target.files;\n\t\t\t\t\tif (files.length === 0) return;\n\n\t\t\t\t\tconst container = document.getElementById('filesContainer');\n\t\t\t\t\tcontainer.innerHTML = '<div class=\"loading\">Loading files...</div>';\n\n\t\t\t\t\tconst formData = new FormData();\n\t\t\t\t\tfor (let i = 0; i < files.length; i++) {\n\t\t\t\t\t\tformData.append('files', files[i]);\n\t\t\t\t\t}\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst response = await fetch('/api/upload', {\n\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\tbody: formData\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\t\tthrow new Error('Failed to upload files');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst data = await response.json();\n\t\t\t\t\t\tcurrentFiles = data.files;\n\t\t\t\t\t\tfileIdMap.clear();\n\t\t\t\t\t\tcurrentFiles.forEach((file, index) => {\n\t\t\t\t\t\t\tfileIdMap.set(file.id || index, file);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsortState = { column: 'track', direction: 'asc' };\n\t\t\t\t\t\tselectionMode = false;\n\t\t\t\t\t\tselectedFileIds.clear();\n\t\t\t\t\t\tdisplayFiles(currentFiles);\n\t\t\t\t\t\tif (currentFiles.length > 0) {\n\t\t\t\t\t\t\tdocument.getElementById('actionsSection').style.display = 'flex';\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tcontainer.innerHTML = '<div class=\"empty-state\" style=\"color: red;\">Error loading files: ' + error.message + '</div>';\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfunction sortFiles(files, column, direction) {\n\t\t\t\t\tconst sorted = [...files];\n\t\t\t\t\tsorted.sort((a, b) => {\n\t\t\t\t\t\tlet aVal = a[column];\n\t\t\t\t\t\tlet bVal = b[column];\n\n\t\t\t\t\t\tif (aVal === null || aVal === undefined || aVal === '') aVal = '';\n\t\t\t\t\t\tif (bVal === null || bVal === undefined || bVal === '') bVal = '';\n\n\t\t\t\t\t\tif (column === 'year' || column === 'track' || column === 'duration' || column === 'size') {\n\t\t\t\t\t\t\taVal = aVal || 0;\n\t\t\t\t\t\t\tbVal = bVal || 0;\n\t\t\t\t\t\t\treturn direction === 'asc' ? aVal - bVal : bVal - aVal;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\taVal = String(aVal).toLowerCase();\n\t\t\t\t\t\tbVal = String(bVal).toLowerCase();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (direction === 'asc') {\n\t\t\t\t\t\t\treturn aVal.localeCompare(bVal);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn bVal.localeCompare(aVal);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn sorted;\n\t\t\t\t}\n\n\t\t\t\tfunction handleSort(column) {\n\t\t\t\t\tif (sortState.column === column) {\n\t\t\t\t\t\tsortState.direction = sortState.direction === 'asc' ? 'desc' : 'asc';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsortState.column = column;\n\t\t\t\t\t\tsortState.direction = 'asc';\n\t\t\t\t\t}\n\t\t\t\t\tdisplayFiles(currentFiles);\n\t\t\t\t}\n\n\t\t\t\tfunction displayFiles(files) {\n\t\t\t\t\tconst container = document.getElementById('filesContainer');\n\t\t\t\t\t\n\t\t\t\t\tif (files.length === 0) {\n\t\t\t\t\t\tcontainer.innerHTML = '<div class=\"empty-state\">No files loaded.</div>';\n\t\t\t\t\t\tdocument.getElementById('actionsSection').style.display = 'none';\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst sortedFiles = sortFiles(files, sortState.column, sortState.direction);\n\n\t\t\t\t\tconst getSortClass = (col) => {\n\t\t\t\t\t\tif (sortState.column === col) {\n\t\t\t\t\t\t\treturn sortState.direction === 'asc' ? 'sortable sort-asc' : 'sortable sort-desc';\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn 'sortable';\n\t\t\t\t\t};\n\n\t\t\t\t\tlet html = '<table class=\"files-table\"><thead><tr>';\n\t\t\t\t\tif (selectionMode) {\n\t\t\t\t\t\thtml += '<th class=\"checkbox-cell\"><input type=\"checkbox\" id=\"selectAll\" onchange=\"toggleSelectAll(this.checked)\"></th>';\n\t\t\t\t\t}\n\t\t\t\t\thtml += '<th>Cover</th>';\n\t\t\t\t\thtml += '<th class=\"' + getSortClass('title') + '\" onclick=\"handleSort(\\'title\\')\">Title<span class=\"sort-indicator\"></span></th>';\n\t\t\t\t\thtml += '<th class=\"' + getSortClass('artist') + '\" onclick=\"handleSort(\\'artist\\')\">Artist<span class=\"sort-indicator\"></span></th>';\n\t\t\t\t\thtml += '<th class=\"' + getSortClass('album') + '\" onclick=\"handleSort(\\'album\\')\">Album<span class=\"sort-indicator\"></span></th>';\n\t\t\t\t\thtml += '<th class=\"' + getSortClass('year') + '\" onclick=\"handleSort(\\'year\\')\">Year<span class=\"sort-indicator\"></span></th>';\n\t\t\t\t\thtml += '<th class=\"' + getSortClass('genre') + '\" onclick=\"handleSort(\\'genre\\')\">Genre<span class=\"sort-indicator\"></span></th>';\n\t\t\t\t\thtml += '<th class=\"' + getSortClass('track') + '\" onclick=\"handleSort(\\'track\\')\">Track<span class=\"sort-indicator\"></span></th>';\n\t\t\t\t\thtml += '<th class=\"' + getSortClass('duration') + '\" onclick=\"handleSort(\\'duration\\')\">Duration<span class=\"sort-indicator\"></span></th>';\n\t\t\t\t\thtml += '<th class=\"' + getSortClass('format') + '\" onclick=\"handleSort(\\'format\\')\">Format<span class=\"sort-indicator\"></span></th>';\n\t\t\t\t\thtml += '<th class=\"' + getSortClass('size') + '\" onclick=\"handleSort(\\'size\\')\">File Size<span class=\"sort-indicator\"></span></th>';\n\t\t\t\t\thtml += '<th></th>';\n\t\t\t\t\thtml += '</tr></thead><tbody>';\n\t\t\t\t\t\n\t\t\t\t\tsortedFiles.forEach((file, index) => {\n\t\t\t\t\t\tconst fileId = file.id || index;\n\t\t\t\t\t\tconst isSelected = selectedFileIds.has(fileId);\n\t\t\t\t\t\thtml += '<tr data-file-id=\"' + fileId + '\"' + (isSelected ? ' class=\"selected\"' : '') + '>';\n\t\t\t\t\t\tif (selectionMode) {\n\t\t\t\t\t\t\thtml += '<td class=\"checkbox-cell\"><input type=\"checkbox\" class=\"file-checkbox\" data-file-id=\"' + fileId + '\"' + (isSelected ? ' checked' : '') + ' onchange=\"toggleFileSelection(\\'' + fileId + '\\', this.checked)\"></td>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (file.coverArt) {\n\t\t\t\t\t\t\thtml += '<td><img src=\"' + escapeHtml(file.coverArt) + '\" alt=\"Cover\" class=\"cover-art\"></td>';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thtml += '<td><div class=\"cover-art-placeholder\">No Cover</div></td>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst changedFields = file.changedFields || [];\n\t\t\t\t\t\thtml += '<td' + (changedFields.includes('title') ? ' class=\"changed\"' : '') + '>' + escapeHtml(file.title || 'Unknown') + '</td>';\n\t\t\t\t\t\thtml += '<td' + (changedFields.includes('artist') ? ' class=\"changed\"' : '') + '>' + escapeHtml(file.artist || '-') + '</td>';\n\t\t\t\t\t\thtml += '<td' + (changedFields.includes('album') ? ' class=\"changed\"' : '') + '>' + escapeHtml(file.album || '-') + '</td>';\n\t\t\t\t\t\thtml += '<td' + (changedFields.includes('year') ? ' class=\"changed\"' : '') + '>' + (file.year !== undefined && file.year !== null ? file.year : '-') + '</td>';\n\t\t\t\t\t\thtml += '<td' + (changedFields.includes('genre') ? ' class=\"changed\"' : '') + '>' + escapeHtml(file.genre || '-') + '</td>';\n\t\t\t\t\t\thtml += '<td' + (changedFields.includes('track') ? ' class=\"changed\"' : '') + '>' + (file.track !== undefined && file.track !== null && file.track !== 0 ? file.track : '-') + '</td>';\n\t\t\t\t\t\thtml += '<td>' + formatDuration(file.duration) + '</td>';\n\t\t\t\t\t\thtml += '<td>' + escapeHtml(file.format || '-') + '</td>';\n\t\t\t\t\t\thtml += '<td>' + formatFileSize(file.size) + '</td>';\n\t\t\t\t\t\thtml += '<td>';\n\t\t\t\t\t\thtml += '<button class=\"btn-primary\" onclick=\"editSingleFile(\\'' + fileId + '\\')\" style=\"padding: 0.25rem 0.5rem; font-size: 0.8rem; margin-bottom: 0.25rem; display: block; width: 100%;\">Edit</button>';\n\t\t\t\t\t\thtml += '<button class=\"btn-primary\" onclick=\"downloadFile(\\'' + fileId + '\\')\" style=\"padding: 0.25rem 0.5rem; font-size: 0.8rem; display: block; width: 100%;\">Download</button>';\n\t\t\t\t\t\thtml += '</td>';\n\t\t\t\t\t\thtml += '</tr>';\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t\thtml += '</tbody></table>';\n\t\t\t\t\tcontainer.innerHTML = html;\n\t\t\t\t\tupdateEditButtonState();\n\t\t\t\t}\n\n\t\t\t\tfunction toggleSelectMode() {\n\t\t\t\t\tselectionMode = !selectionMode;\n\t\t\t\t\tconst btn = document.getElementById('selectBtn');\n\t\t\t\t\tconst editBtn = document.getElementById('editBtn');\n\t\t\t\t\tconst downloadBtn = document.getElementById('downloadBtn');\n\t\t\t\t\tif (selectionMode) {\n\t\t\t\t\t\tbtn.classList.add('active');\n\t\t\t\t\t\tbtn.textContent = 'Cancel Selection';\n\t\t\t\t\t\teditBtn.style.display = 'inline-block';\n\t\t\t\t\t\tdownloadBtn.style.display = 'inline-block';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbtn.classList.remove('active');\n\t\t\t\t\t\tbtn.textContent = 'Select';\n\t\t\t\t\t\tselectedFileIds.clear();\n\t\t\t\t\t\tdocument.getElementById('editForm').classList.remove('active');\n\t\t\t\t\t\teditBtn.style.display = 'none';\n\t\t\t\t\t\tdownloadBtn.style.display = 'none';\n\t\t\t\t\t}\n\t\t\t\t\tupdateEditButtonState();\n\t\t\t\t\tdisplayFiles(currentFiles);\n\t\t\t\t}\n\n\t\t\t\tfunction toggleFileSelection(fileId, checked) {\n\t\t\t\t\tif (checked) {\n\t\t\t\t\t\tselectedFileIds.add(fileId);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tselectedFileIds.delete(fileId);\n\t\t\t\t\t}\n\t\t\t\t\tconst row = document.querySelector('tr[data-file-id=\"' + fileId + '\"]');\n\t\t\t\t\tif (row) {\n\t\t\t\t\t\tif (checked) {\n\t\t\t\t\t\t\trow.classList.add('selected');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trow.classList.remove('selected');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tupdateEditButtonState();\n\t\t\t\t\tupdateSelectAllCheckbox();\n\t\t\t\t}\n\n\t\t\t\tfunction toggleSelectAll(checked) {\n\t\t\t\t\tconst sortedFiles = sortFiles(currentFiles, sortState.column, sortState.direction);\n\t\t\t\t\tsortedFiles.forEach((file, index) => {\n\t\t\t\t\t\tconst fileId = file.id || index;\n\t\t\t\t\t\tif (checked) {\n\t\t\t\t\t\t\tselectedFileIds.add(fileId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tselectedFileIds.delete(fileId);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst checkbox = document.querySelector('.file-checkbox[data-file-id=\"' + fileId + '\"]');\n\t\t\t\t\t\tif (checkbox) {\n\t\t\t\t\t\t\tcheckbox.checked = checked;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst row = document.querySelector('tr[data-file-id=\"' + fileId + '\"]');\n\t\t\t\t\t\tif (row) {\n\t\t\t\t\t\t\tif (checked) {\n\t\t\t\t\t\t\t\trow.classList.add('selected');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trow.classList.remove('selected');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tupdateEditButtonState();\n\t\t\t\t}\n\n\t\t\t\tfunction updateSelectAllCheckbox() {\n\t\t\t\t\tconst selectAllCheckbox = document.getElementById('selectAll');\n\t\t\t\t\tif (selectAllCheckbox) {\n\t\t\t\t\t\tconst sortedFiles = sortFiles(currentFiles, sortState.column, sortState.direction);\n\t\t\t\t\t\tconst allSelected = sortedFiles.every((file, index) => {\n\t\t\t\t\t\t\tconst fileId = file.id || index;\n\t\t\t\t\t\t\treturn selectedFileIds.has(fileId);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tselectAllCheckbox.checked = allSelected && sortedFiles.length > 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction updateEditButtonState() {\n\t\t\t\t\tconst editBtn = document.getElementById('editBtn');\n\t\t\t\t\tconst downloadBtn = document.getElementById('downloadBtn');\n\t\t\t\t\tconst hasSelection = selectedFileIds.size > 0;\n\t\t\t\t\teditBtn.disabled = !hasSelection;\n\t\t\t\t\tdownloadBtn.disabled = !hasSelection;\n\t\t\t\t}\n\n\t\t\t\tfunction editSingleFile(fileId) {\n\t\t\t\t\tselectedFileIds.clear();\n\t\t\t\t\tselectedFileIds.add(fileId);\n\t\t\t\t\tif (!selectionMode) {\n\t\t\t\t\t\tselectionMode = true;\n\t\t\t\t\t\tconst btn = document.getElementById('selectBtn');\n\t\t\t\t\t\tbtn.classList.add('active');\n\t\t\t\t\t\tbtn.textContent = 'Cancel Selection';\n\t\t\t\t\t\tconst editBtn = document.getElementById('editBtn');\n\t\t\t\t\t\tconst downloadBtn = document.getElementById('downloadBtn');\n\t\t\t\t\t\teditBtn.style.display = 'inline-block';\n\t\t\t\t\t\tdownloadBtn.style.display = 'inline-block';\n\t\t\t\t\t}\n\t\t\t\t\tupdateEditButtonState();\n\t\t\t\t\tshowEditForm();\n\t\t\t\t\tdisplayFiles(currentFiles);\n\t\t\t\t}\n\n\t\t\t\tfunction showEditForm() {\n\t\t\t\t\tif (selectedFileIds.size === 0) return;\n\t\t\t\t\t\n\t\t\t\t\tconst selectedFiles = Array.from(selectedFileIds).map(id => fileIdMap.get(id)).filter(f => f);\n\t\t\t\t\tconst isMultiple = selectedFiles.length > 1;\n\t\t\t\t\t\n\t\t\t\t\tconst commonTitle = getCommonValue(selectedFiles, 'title');\n\t\t\t\t\tconst commonArtist = getCommonValue(selectedFiles, 'artist');\n\t\t\t\t\tconst commonAlbum = getCommonValue(selectedFiles, 'album');\n\t\t\t\t\tconst commonYear = getCommonValue(selectedFiles, 'year');\n\t\t\t\t\tconst commonTrack = getCommonValue(selectedFiles, 'track');\n\t\t\t\t\tconst commonGenre = getCommonValue(selectedFiles, 'genre');\n\t\t\t\t\t\n\t\t\t\t\tdocument.getElementById('editTitle').value = commonTitle || '';\n\t\t\t\t\tdocument.getElementById('editArtist').value = commonArtist || '';\n\t\t\t\t\tdocument.getElementById('editAlbum').value = commonAlbum || '';\n\t\t\t\t\tdocument.getElementById('editYear').value = (commonYear !== undefined && commonYear !== null) ? commonYear : '';\n\t\t\t\t\tdocument.getElementById('editTrack').value = (commonTrack !== undefined && commonTrack !== null && commonTrack !== 0) ? commonTrack : '';\n\t\t\t\t\tdocument.getElementById('editGenre').value = commonGenre || '';\n\t\t\t\t\t\n\t\t\t\t\tdocument.getElementById('editTitle').disabled = isMultiple;\n\t\t\t\t\tdocument.getElementById('editTrack').disabled = isMultiple;\n\t\t\t\t\t\n\t\t\t\t\tdocument.getElementById('editForm').classList.add('active');\n\t\t\t\t}\n\n\t\t\t\tfunction getCommonValue(files, field) {\n\t\t\t\t\tif (files.length === 0) return '';\n\t\t\t\t\tconst firstValue = files[0][field];\n\t\t\t\t\tif (firstValue === undefined || firstValue === null) return '';\n\t\t\t\t\tif (files.every(f => {\n\t\t\t\t\t\tconst val = f[field];\n\t\t\t\t\t\tif (val === undefined || val === null) return firstValue === '';\n\t\t\t\t\t\treturn val === firstValue;\n\t\t\t\t\t})) {\n\t\t\t\t\t\treturn firstValue;\n\t\t\t\t\t}\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\n\t\t\t\tfunction cancelEdit() {\n\t\t\t\t\tdocument.getElementById('editForm').classList.remove('active');\n\t\t\t\t\tdocument.getElementById('editTitle').value = '';\n\t\t\t\t\tdocument.getElementById('editArtist').value = '';\n\t\t\t\t\tdocument.getElementById('editAlbum').value = '';\n\t\t\t\t\tdocument.getElementById('editYear').value = '';\n\t\t\t\t\tdocument.getElementById('editTrack').value = '';\n\t\t\t\t\tdocument.getElementById('editGenre').value = '';\n\t\t\t\t\tdocument.getElementById('editTitle').disabled = false;\n\t\t\t\t\tdocument.getElementById('editTrack').disabled = false;\n\t\t\t\t}\n\n\t\t\t\tasync function saveTags() {\n\t\t\t\t\tif (selectedFileIds.size === 0) return;\n\t\t\t\t\t\n\t\t\t\t\tconst selectedFiles = Array.from(selectedFileIds).map(id => fileIdMap.get(id)).filter(f => f);\n\t\t\t\t\tconst isMultiple = selectedFiles.length > 1;\n\t\t\t\t\t\n\t\t\t\t\tconst artist = document.getElementById('editArtist').value.trim();\n\t\t\t\t\tconst album = document.getElementById('editAlbum').value.trim();\n\t\t\t\t\tconst yearStr = document.getElementById('editYear').value.trim();\n\t\t\t\t\tconst genre = document.getElementById('editGenre').value.trim();\n\t\t\t\t\t\n\t\t\t\t\tlet year = null;\n\t\t\t\t\tif (yearStr !== '') {\n\t\t\t\t\t\tconst yearNum = parseInt(yearStr, 10);\n\t\t\t\t\t\tif (!isNaN(yearNum) && yearNum > 0) {\n\t\t\t\t\t\t\tyear = yearNum;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst updates = {\n\t\t\t\t\t\tfileIds: Array.from(selectedFileIds),\n\t\t\t\t\t\tartist: artist === '' ? null : artist,\n\t\t\t\t\t\talbum: album === '' ? null : album,\n\t\t\t\t\t\tyear: year,\n\t\t\t\t\t\tgenre: genre === '' ? null : genre\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\tconst fieldsToUpdate = new Set(['artist', 'album', 'year', 'genre']);\n\t\t\t\t\t\n\t\t\t\t\tif (!isMultiple) {\n\t\t\t\t\t\tconst title = document.getElementById('editTitle').value.trim();\n\t\t\t\t\t\tconst trackStr = document.getElementById('editTrack').value.trim();\n\t\t\t\t\t\tupdates.title = title === '' ? null : title;\n\t\t\t\t\t\tfieldsToUpdate.add('title');\n\t\t\t\t\t\tif (trackStr !== '') {\n\t\t\t\t\t\t\tconst trackNum = parseInt(trackStr, 10);\n\t\t\t\t\t\t\tif (!isNaN(trackNum) && trackNum > 0) {\n\t\t\t\t\t\t\t\tupdates.track = trackNum;\n\t\t\t\t\t\t\t\tfieldsToUpdate.add('track');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconsole.log('Update payload:', JSON.stringify(updates));\n\t\t\t\t\tconsole.log('Is multiple:', isMultiple, 'Has track:', 'track' in updates, 'Has title:', 'title' in updates);\n\t\t\t\t\tconsole.log('Fields to update:', Array.from(fieldsToUpdate));\n\t\t\t\t\t\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconsole.log('Sending update request:', updates);\n\t\t\t\t\t\tconst response = await fetch('/api/update-tags', {\n\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbody: JSON.stringify(updates)\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\tconsole.log('Response status:', response.status, response.statusText);\n\t\t\t\t\t\tconsole.log('Response headers:', Object.fromEntries(response.headers.entries()));\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\t\tconst errorText = await response.text();\n\t\t\t\t\t\t\tconsole.error('Error response:', errorText);\n\t\t\t\t\t\t\tthrow new Error('Failed to update tags: ' + errorText);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst responseText = await response.text();\n\t\t\t\t\t\tconsole.log('Response body:', responseText);\n\t\t\t\t\t\t\n\t\t\t\t\t\tlet data;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tdata = JSON.parse(responseText);\n\t\t\t\t\t\t\tconsole.log('Parsed data:', data);\n\t\t\t\t\t\t} catch (parseError) {\n\t\t\t\t\t\t\tconsole.error('Failed to parse JSON:', parseError, 'Response text:', responseText);\n\t\t\t\t\t\t\tthrow new Error('Invalid JSON response from server: ' + responseText.substring(0, 100));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!data || !data.files) {\n\t\t\t\t\t\t\tconsole.error('Invalid response structure:', data);\n\t\t\t\t\t\t\tthrow new Error('Invalid response from server. Expected data.files, got: ' + JSON.stringify(data));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (data.files.length === 0) {\n\t\t\t\t\t\t\talert('No files were updated. Make sure the files are MP3 format.');\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tdata.files.forEach(updatedFile => {\n\t\t\t\t\t\t\tconsole.log('Processing updated file:', updatedFile);\n\t\t\t\t\t\t\tconst index = currentFiles.findIndex(f => f.id === updatedFile.id);\n\t\t\t\t\t\t\tconsole.log('Found index:', index, 'for file ID:', updatedFile.id);\n\t\t\t\t\t\t\tif (index !== -1) {\n\t\t\t\t\t\t\t\tconsole.log('Before update - Title:', currentFiles[index].title, 'Artist:', currentFiles[index].artist, 'Album:', currentFiles[index].album, 'Year:', currentFiles[index].year, 'Track:', currentFiles[index].track, 'Genre:', currentFiles[index].genre);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (!currentFiles[index].changedFields) {\n\t\t\t\t\t\t\t\t\tcurrentFiles[index].changedFields = [];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif (!isMultiple && 'title' in updatedFile) {\n\t\t\t\t\t\t\t\t\tif (currentFiles[index].title !== (updatedFile.title || '')) {\n\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].title = updatedFile.title || '';\n\t\t\t\t\t\t\t\t\t\tif (!currentFiles[index].changedFields.includes('title')) {\n\t\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].changedFields.push('title');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ('artist' in updatedFile) {\n\t\t\t\t\t\t\t\t\tif (currentFiles[index].artist !== (updatedFile.artist || '')) {\n\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].artist = updatedFile.artist || '';\n\t\t\t\t\t\t\t\t\t\tif (!currentFiles[index].changedFields.includes('artist')) {\n\t\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].changedFields.push('artist');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ('album' in updatedFile) {\n\t\t\t\t\t\t\t\t\tif (currentFiles[index].album !== (updatedFile.album || '')) {\n\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].album = updatedFile.album || '';\n\t\t\t\t\t\t\t\t\t\tif (!currentFiles[index].changedFields.includes('album')) {\n\t\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].changedFields.push('album');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ('year' in updatedFile) {\n\t\t\t\t\t\t\t\t\tconst newYear = updatedFile.year !== undefined && updatedFile.year !== null ? updatedFile.year : 0;\n\t\t\t\t\t\t\t\t\tif (currentFiles[index].year !== newYear) {\n\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].year = newYear;\n\t\t\t\t\t\t\t\t\t\tif (!currentFiles[index].changedFields.includes('year')) {\n\t\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].changedFields.push('year');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!isMultiple && 'track' in updatedFile) {\n\t\t\t\t\t\t\t\t\tconst newTrack = updatedFile.track !== undefined && updatedFile.track !== null ? updatedFile.track : 0;\n\t\t\t\t\t\t\t\t\tif (currentFiles[index].track !== newTrack) {\n\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].track = newTrack;\n\t\t\t\t\t\t\t\t\t\tif (!currentFiles[index].changedFields.includes('track')) {\n\t\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].changedFields.push('track');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ('genre' in updatedFile) {\n\t\t\t\t\t\t\t\t\tif (currentFiles[index].genre !== (updatedFile.genre || '')) {\n\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].genre = updatedFile.genre || '';\n\t\t\t\t\t\t\t\t\t\tif (!currentFiles[index].changedFields.includes('genre')) {\n\t\t\t\t\t\t\t\t\t\t\tcurrentFiles[index].changedFields.push('genre');\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tconsole.log('After update - Title:', currentFiles[index].title, 'Artist:', currentFiles[index].artist, 'Album:', currentFiles[index].album, 'Year:', currentFiles[index].year, 'Track:', currentFiles[index].track, 'Genre:', currentFiles[index].genre);\n\t\t\t\t\t\t\t\tfileIdMap.set(updatedFile.id, currentFiles[index]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.error('File not found in currentFiles. Updated file ID:', updatedFile.id);\n\t\t\t\t\t\t\t\tconsole.log('Current file IDs:', currentFiles.map(f => f.id));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\tcancelEdit();\n\t\t\t\t\t\tselectedFileIds.clear();\n\t\t\t\t\t\tdisplayFiles(currentFiles);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\talert('Error updating tags: ' + error.message);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction formatDuration(seconds) {\n\t\t\t\t\tif (!seconds) return 'Unknown';\n\t\t\t\t\tconst mins = Math.floor(seconds / 60);\n\t\t\t\t\tconst secs = Math.floor(seconds % 60);\n\t\t\t\t\treturn mins + ':' + (secs < 10 ? '0' : '') + secs;\n\t\t\t\t}\n\n\t\t\t\tfunction formatFileSize(bytes) {\n\t\t\t\t\tif (!bytes) return 'Unknown';\n\t\t\t\t\tif (bytes < 1024) return bytes + ' B';\n\t\t\t\t\tif (bytes < 1024 * 1024) return (bytes / 1024).toFixed(2) + ' KB';\n\t\t\t\t\treturn (bytes / (1024 * 1024)).toFixed(2) + ' MB';\n\t\t\t\t}\n\n\t\t\t\tfunction escapeHtml(text) {\n\t\t\t\t\tconst div = document.createElement('div');\n\t\t\t\t\tdiv.textContent = text;\n\t\t\t\t\treturn div.innerHTML;\n\t\t\t\t}\n\n\t\t\t\tfunction downloadFile(fileId) {\n\t\t\t\t\twindow.open('/api/download/' + fileId, '_blank');\n\t\t\t\t}\n\n\t\t\t\tasync function downloadSelectedFiles() {\n\t\t\t\t\tif (selectedFileIds.size === 0) return;\n\t\t\t\t\t\n\t\t\t\t\tconst fileIds = Array.from(selectedFileIds);\n\t\t\t\t\t\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst response = await fetch('/api/download-selected', {\n\t\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbody: JSON.stringify({ fileIds: fileIds })\n\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\t\tthrow new Error('Failed to download selected files');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst contentDisposition = response.headers.get('Content-Disposition');\n\t\t\t\t\t\tlet filename = 'selected-tracks.zip';\n\t\t\t\t\t\tif (contentDisposition) {\n\t\t\t\t\t\t\tconst filenameMatch = contentDisposition.match(/filename=\"(.+)\"/);\n\t\t\t\t\t\t\tif (filenameMatch) {\n\t\t\t\t\t\t\t\tfilename = filenameMatch[1];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tconst blob = await response.blob();\n\t\t\t\t\t\tconst url = window.URL.createObjectURL(blob);\n\t\t\t\t\t\tconst a = document.createElement('a');\n\t\t\t\t\t\ta.href = url;\n\t\t\t\t\t\ta.download = filename;\n\t\t\t\t\t\tdocument.body.appendChild(a);\n\t\t\t\t\t\ta.click();\n\t\t\t\t\t\tdocument.body.removeChild(a);\n\t\t\t\t\t\twindow.URL.revokeObjectURL(url);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tconsole.error('Error downloading selected files:', error);\n\t\t\t\t\t\talert('Failed to download selected files');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction downloadAllFiles() {\n\t\t\t\t\twindow.location.href = '/api/download-all';\n\t\t\t\t}\n\t\t\t</script></body></html>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
